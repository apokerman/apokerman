import requests
from bs4 import BeautifulSoup
import pandas as pd

cookies = {
    'BIDUPSID': 'B673A3300C9BA66087E2E2F7B40A10E5',
    'PSTM': '1705391944',
    'BAIDUID': 'B673A3300C9BA660707CA9BC5854D43D:FG=1',
    'BD_UPN': '12314753',
    'newlogin': '1',
    'BDUSS': 'NHQ2tMYTVCNHFwOTU3RTZiR2V2Y2kxZDI3NzJIVWh2aVlKdU84enp2UTB5YzVsSVFBQUFBJCQAAAAAAAAAAAEAAAAE-IP1t~vUqGhlYXJ0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQ8p2U0PKdlQl',
    'BDUSS_BFESS': 'NHQ2tMYTVCNHFwOTU3RTZiR2V2Y2kxZDI3NzJIVWh2aVlKdU84enp2UTB5YzVsSVFBQUFBJCQAAAAAAAAAAAEAAAAE-IP1t~vUqGhlYXJ0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQ8p2U0PKdlQl',
    'H_PS_PSSID': '39825_39998_40044_40120',
    'BAIDUID_BFESS': 'B673A3300C9BA660707CA9BC5854D43D:FG=1',
    'ZFY': 'umtNQfmrPLyaF6hXXSure8CqJkpWBYQqTqVH7Np3hn0:C',
    'BDORZ': 'B490B5EBF6F3CD402E515D22BCDA1598',
    'H_WISE_SIDS': '110085_281879_288153_289949_289951_289955_282930_290343_290555_290562_269892_286864_283016_291868_291947_292135_292168_292246_292250_292251_282466_292505_291328_292172_293237_289527_290994_292677_272561_291447_287702_289024',
    'H_WISE_SIDS_BFESS': '110085_281879_288153_289949_289951_289955_282930_290343_290555_290562_269892_286864_283016_291868_291947_292135_292168_292246_292250_292251_282466_292505_291328_292172_293237_289527_290994_292677_272561_291447_287702_289024',
    'baikeVisitId': '851232dc-4793-4b5b-8077-5267fe70f246',
    'Hm_lvt_aec699bb6442ba076c8981c6dc490771': '1705470530,1705567175,1705625556,1705629665',
    'BAIDU_WISE_UID': 'wapp_1705723032104_19',
    'arialoadData': 'false',
    'BA_HECTOR': '2la42la48ga40l80852l81049kv3qp1iqmn1v1t',
    'RT': '"z=1&dm=baidu.com&si=ecb37a0a-eb62-476a-9bc0-cf01b8ad8f62&ss=lrlovraz&sl=2&tt=87q&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=97h&ul=btif&hd=btin"',
    'BDRCVFR[feWj1Vr5u3D]': 'I67x6TjHwwYf0',
    'BD_CK_SAM': '1',
    'PSINO': '6',
    'H_PS_645EC': '7ec7HJqHizUbo1dhdUvg4oksC2bRqnzND6sluoojqCjRU0f%2BqvwknDjXfC%2BM1QJN%2F5k3',
    'delPer': '0',
    'COOKIE_SESSION': '3837_0_9_9_6_19_1_0_8_8_21_2_3826_0_4_0_1705735960_0_1705735956%7C9%23418_20_1705627555%7C5',
}

headers = {
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
    'Accept-Language': 'zh-CN,zh;q=0.9',
    'Cache-Control': 'max-age=0',
    'Connection': 'keep-alive',
    # 'Cookie': 'BIDUPSID=B673A3300C9BA66087E2E2F7B40A10E5; PSTM=1705391944; BAIDUID=B673A3300C9BA660707CA9BC5854D43D:FG=1; BD_UPN=12314753; newlogin=1; BDUSS=NHQ2tMYTVCNHFwOTU3RTZiR2V2Y2kxZDI3NzJIVWh2aVlKdU84enp2UTB5YzVsSVFBQUFBJCQAAAAAAAAAAAEAAAAE-IP1t~vUqGhlYXJ0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQ8p2U0PKdlQl; BDUSS_BFESS=NHQ2tMYTVCNHFwOTU3RTZiR2V2Y2kxZDI3NzJIVWh2aVlKdU84enp2UTB5YzVsSVFBQUFBJCQAAAAAAAAAAAEAAAAE-IP1t~vUqGhlYXJ0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQ8p2U0PKdlQl; H_PS_PSSID=39825_39998_40044_40120; BAIDUID_BFESS=B673A3300C9BA660707CA9BC5854D43D:FG=1; ZFY=umtNQfmrPLyaF6hXXSure8CqJkpWBYQqTqVH7Np3hn0:C; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; H_WISE_SIDS=110085_281879_288153_289949_289951_289955_282930_290343_290555_290562_269892_286864_283016_291868_291947_292135_292168_292246_292250_292251_282466_292505_291328_292172_293237_289527_290994_292677_272561_291447_287702_289024; H_WISE_SIDS_BFESS=110085_281879_288153_289949_289951_289955_282930_290343_290555_290562_269892_286864_283016_291868_291947_292135_292168_292246_292250_292251_282466_292505_291328_292172_293237_289527_290994_292677_272561_291447_287702_289024; baikeVisitId=851232dc-4793-4b5b-8077-5267fe70f246; Hm_lvt_aec699bb6442ba076c8981c6dc490771=1705470530,1705567175,1705625556,1705629665; BAIDU_WISE_UID=wapp_1705723032104_19; arialoadData=false; BA_HECTOR=2la42la48ga40l80852l81049kv3qp1iqmn1v1t; RT="z=1&dm=baidu.com&si=ecb37a0a-eb62-476a-9bc0-cf01b8ad8f62&ss=lrlovraz&sl=2&tt=87q&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=97h&ul=btif&hd=btin"; BDRCVFR[feWj1Vr5u3D]=I67x6TjHwwYf0; BD_CK_SAM=1; PSINO=6; H_PS_645EC=7ec7HJqHizUbo1dhdUvg4oksC2bRqnzND6sluoojqCjRU0f%2BqvwknDjXfC%2BM1QJN%2F5k3; delPer=0; COOKIE_SESSION=3837_0_9_9_6_19_1_0_8_8_21_2_3826_0_4_0_1705735960_0_1705735956%7C9%23418_20_1705627555%7C5',
    'Referer': 'https://www.baidu.com/s?wd=curl%E8%BD%ACpython%E5%9C%A8%E7%BA%BF&rsv_spt=1&rsv_iqid=0xa0dfa2ed000eb27f&issp=1&f=3&rsv_bp=1&rsv_idx=2&ie=utf-8&tn=baiduhome_pg&rsv_dl=ts_0&rsv_enter=1&rsv_sug3=11&rsv_sug1=12&rsv_sug7=100&rsv_sug2=1&rsv_btype=i&prefixsug=curl%25E8%25BD%25AC&rsp=0&inputT=6948&rsv_sug4=10775',
    'Sec-Fetch-Dest': 'document',
    'Sec-Fetch-Mode': 'navigate',
    'Sec-Fetch-Site': 'same-origin',
    'Sec-Fetch-User': '?1',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
    'sec-ch-ua': '"Not_A Brand";v="8", "Chromium";v="120", "Google Chrome";v="120"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Windows"',
}

response = requests.get('https://www.baidu.com/', cookies=cookies, headers=headers)

html_content = response.text

soup = BeautifulSoup(html_content, 'html.parser')
titles = soup.find_all('span', class_='title-content-title')
# 提取文本内容
texts = [title.text for title in titles]

# 创建一个DataFrame
df = pd.DataFrame(texts, columns=['标题'])

# 将DataFrame保存到Excel文件
df.to_excel('output.xlsx', index=False, engine='openpyxl')